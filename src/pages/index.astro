---
import BaseHead from "../components/BaseHead.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../consts";
import { getCollection } from "astro:content";
import Masthead from "@/components/Masthead.astro";
import Content from "@/components/Content.astro";
import RevealOnScroll from "@/components/react/RevealOnScroll";
import MagicBento from "@/components/react/MagicBento";
import FormattedDate from "@/components/FormattedDate.astro";
import { Image } from "astro:assets";

const posts = (await getCollection("blog")).sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<!doctype html>
<html lang="en">
    <head>
        <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
    </head>
    <body>
        <Header title={SITE_TITLE} />
        <main class="pt-[56px]" transition:animate="fade">
            <Masthead />
            <Content>
                <section>
                    <RevealOnScroll client:visible>
                        <p class="mb-8 indent-4">
                            Welcome to my tech corner! Here I document
                            solutions, share tutorials, and reflect on my
                            experiences in software development and site
                            reliability engineering. Hope you find something
                            useful.
                            <a
                                class="inline-flex items-center gap-1 indent-1 text-orange-500"
                                href="/about"
                            >
                                Learn more about me
                            </a>
                        </p>
                    </RevealOnScroll>
                </section>
                <section>
                    <MagicBento
                        client:visible
                        items={posts.map((post) => ({
                            title: post.data.title,
                            description: post.data.description,
                            href: `/blog/${post.id}/`,
                            imageSrc:
                                post.data.heroImage.image.src ?? undefined,
                            dateText: new Date(
                                post.data.pubDate
                            ).toLocaleDateString(undefined, {
                                year: "numeric",
                                month: "short",
                                day: "2-digit",
                            }),
                        }))}
                        columns={1}
                        textAutoHide={false}
                        enableStars={true}
                        enableBorderGlow={true}
                        enableTilt={true}
                        enableMagnetism={true}
                        clickEffect={true}
                        particleCount={12}
                        glowColor="var(--color-primary)"
                    />
                </section>
            </Content>
        </main>
        <Footer />
    </body>
</html>
