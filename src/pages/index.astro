---
import BaseHead from "../components/BaseHead.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../consts";
import { getCollection } from "astro:content";
import Content from "@/components/Content.astro";
import RevealOnScroll from "@/components/react/RevealOnScroll";
import ArticleList from "@/components/ArticleList.astro";
import AboutMe from "@/components/AboutMe.astro";

const allPosts = (await getCollection("blog")).sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
// Display only the latest 3 posts on the index page
const posts = allPosts.slice(0, 3);
// Check if there are more posts to show
const hasMorePosts = allPosts.length > 3;
---

<!doctype html>
<html lang="en">
    <head>
        <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
    </head>
    <body class="min-h-screen flex flex-col">
        <Header title={SITE_TITLE} />
        <main class="pt-[56px] flex-1" transition:animate="fade">
            <article
                class="mx-auto max-w-3xl px-4 sm:px-6 lg:px-8 my-auto mt-6 flex flex-col md:flex-row"
            >
                <div class="w-full md:w-3/5 lg:w-3/5">
                    <ArticleList posts={posts} />
                    {
                        hasMorePosts && (
                            <div class="mt-8 text-center">
                                <a
                                    href="/blogs/2"
                                    class="inline-block group py-2 px-4 text-sm font-medium text-foreground hover:text-popover transition-colors duration-300"
                                    data-astro-prefetch="viewport"
                                >
                                    See other posts
                                    <span class="inline-block ml-1 opacity-0 group-hover:opacity-100 transition-opacity duration-300 translate-x-1 group-hover:translate-x-0">
                                        â†’
                                    </span>
                                </a>
                            </div>
                        )
                    }
                </div>

                <aside
                    class="w-full md:w-2/4 lg:w-2/5 md:pl-8 lg:pl-12 mt-12 mb-12 md:mt-0"
                >
                    <AboutMe />
                </aside>
            </article>
        </main>
        <Footer />
    </body>
</html>
